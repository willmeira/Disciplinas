---
title: "3º CE231 - Modelos Markovianos"
subtitle: "III Decomposição do espaço de estados"
author: "XXXX"
date: "17 de Agosto de 2020"
output:
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.width=8, fig.height=4, fig.path='Figs/',                     echo=F,warning=T,message=FALSE,cache=F,comment=NULL)
```

```{r}
##LIMPESA DO HISTORICO DO R
rm(list = ls())

##PACOTES USADOS
library(dplyr)
library(markovchain)
```

### Exercicio 1

 Mostrar que se o estado $x$ é recorrente e não se comunica com o estado $y_{i}$ então $\gamma_{x,y} = 0$

**R:**
Sendo $x$ recorrente, então $\rho_{x,x}=1$. Dessa forma a probabilidade de sair de $x$ e chegar em $y$ é 0, ou seja $\rho_{x,y}=0$

$\gamma_{x,y}^{n} = 0$ porque $\rho_{x,y}=0$

*Outra forma de demonstrar seria:*

S(x,y)

x é um estado recorrente logo {$_{\rho_{x,x}=1*}^{\rho_{x,y}=0**}$

Seja $c_{n}$ uma cadeia de Markov com espaço de estados S 

$N(y)$ = nº vezes que a cadeia está no espaço y

$N(y)=\sum^{\infty}_{n=1} l_{y}(C_{n})$

também observamos que $N(y)\geqslant 1$ é o mesmo que $\Gamma_{y}<\infty$ logo:

$\rho_{x}(N(y)\geqslant 1)=\rho_{x}(\Gamma<\infty)=\rho_{x,y}$

Sejam m e n números inteiros positivos. Sabemos que a prob com a qual a cadeia começando em $x$ visitar a primeira vez $y$ no tempo m e visitar novamente no tempo n é:

$\rho_{x}(\Gamma_{y}=m)\rho_{y}(\Gamma_{y}=n)$

Logo:

$\rho(N(y)\geqslant 2) = \sum^{\infty}_{m=1}\sum^{\infty}_{n=1}\rho_{x}(\Gamma_{y}=m)\rho_{y}(\Gamma_{y}=n)=[\sum^{\infty}_{m=1}\rho_{x}(\Gamma_{y}=m)][\sum^{\infty}_{n=1}\rho_{y}(\Gamma_{y}=n)]=$

$\rho_{x,x}*\rho_{x,y}**=1.0=0$

### Exercicio 3
 
 Mostre que se o estado $x$ se comunica com $y$ e $y$ se comunica com $z$, então $x$ se comunica com $z$

**R:**
Pela Definição 19, temos que se $x$ se comunica com $y$, então temos $\rho_{x}(\Gamma_{y}=n)>0$ para algum $n$ finito. Portanto do mesmo princípio, se $y$ se comunica com $z$ temos $\rho_{y}(\Gamma_{z}=m)>0$ para algum $m$ finito. Portanto $\rho_{x}(\Gamma_{z}=m+n)>0$ o que demonstra que $x$ se comunica com $z$


### Exercicio 4

$$\Gamma = \begin{pmatrix}
0.0 & 0.5 & 0.0 & 0.0 & 0.5 & 0.0 & 0.0 & 0.0 & 0.0 \\
0.0 & 0.0 & 1.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\
0.0 & 0.0 & 0.0 & 1.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\
1.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\
0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 1.0 & 0.0 & 0.0 & 0.0 \\
0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 1.0 & 0.0 & 0.0 \\
0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 1.0 & 0.0 \\
0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 1.0 \\
1.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0
\end{pmatrix}$$
 
 Esta cadeia é irredutível? ou seja, prove que o conjunto de estados irredutíveis $F$ satisfaz $F=S$, sendo $S=(1,\cdots ,9)$. Prove também que está cadeia é recorrente, ou seja, prove que cada estado em $S$ é recorrente 
 
**R:**

```{r}
library(markovchain)
mat4 <- matrix(c(0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,
                 0.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
                 0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
                 0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,
                 0.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
                 0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,
                 0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,
                 0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,
                 0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0), nrow=9)
estados4 = c("0","1","2","3","4","5","6","7","8")
mc4 <- new("markovchain", states=estados4, transitionMatrix=mat4, name="Exercicio 4")
mc4
transientStates(mc4)
steadyStates(mc4)
steadyStates(mc4^1000)
transientStates(mc4)
summary(mc4)
```


### Exercicio 6

A **Fiscalía de Mídia** identificou seis estados associados à televisão: 0 (nunca assiste TV), 1 (assiste apenas notícias), 2 (assiste TV com bastante frequência), 3 (viciado), 4 (em modificação de comportamento), 5 (morte encefálica). As transições de estado para estado podem ser modeladas como uma cadeia de Markov com a seguinte matriz de transição:

$$\Gamma = \begin{pmatrix}
1.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\
0.5 & 0.0 & 0.5 & 0.0 & 0.0 & 0.0 \\
0.1 & 0.0 & 0.5 & 0.3 & 0.0 & 0.1 \\
0.0 & 0.0 & 0.0 & 0.7 & 0.1 & 0.2 \\
1/3 & 0.0 & 0.0 & 1/3 & 1/3 & 0.0 \\
0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 1.0
\end{pmatrix}$$

> **a)** Quais estados são recorrentes e quais transientes.

> **b)** Começando do estado 1, qual é a probabilidade de o estado 5 ser atingido antes do estado 0, ou seja, qual é a probabilidade de um visualizador de notícias acabar com morte cerebral?

**R:**

