require(car)
require(MASS)
require(faraway)
require(effects)
options(scipen = 5)
head(Chile)
summary(Chile)
Chile2$vote <- factor(Chile2$vote)
Chile2 <- Chile[which(Chile$vote%in%c('N','Y')),]
Chile2$vote <- factor(Chile2$vote)
summary(Chile2)
library(DAAG)
library(gridExtra)
library(corrplot)
library(car)
library(statmod)
library(effects)
library(gplots)
library(gtools)
library(gdata)
library(ROCR)
library(faraway)
library(ggplot2)
library(hnp)
library(effects)
# pacotes necessÃ¡rios
library(DAAG)
library(gridExtra)
library(corrplot)
library(car)
library(statmod)
library(effects)
library(gplots)
library(gtools)
library(gdata)
library(ROCR)
library(faraway)
library(ggplot2)
library(hnp)
#*********************************
## Carregando e ajustando a base de dados
## 1. Descrição dos dados
#*********************************
data("nassCDS")
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
#selecionando covariÃ¡veis
dados <-dados[,c(-2,-9,-10,-11,-15)]
#ajustando as variÃ¡veis
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09 mph',
ifelse(dados$dvcat == '10-24','10-24 mph',
ifelse(dados$dvcat == '25-39','25-39 mph',
ifelse(dados$dvcat == '40-54','40-54 mph','55+ mph')))))
dados$dead <- as.numeric(ifelse(dados$dead == 'alive',1,0))
dados$airbag <- as.numeric(ifelse(dados$airbag == 'airbag',1,0))
dados$seatbelt <- as.numeric(ifelse(dados$seatbelt == 'belted',1,0))
dados$frontal <- as.numeric(ifelse(dados$frontal == 1,1,0))
dados$sex <- as.factor(ifelse(dados$sex == 'm', 'Masc','Fem'))
dados$occRole <- as.numeric(ifelse(dados$occRole == 'driver',1,0))
dados$deploy<-as.factor(ifelse(dados$deploy == 1,'Sim','Não'))
dados$injSeverity<-as.ordered(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
#*********************************
## AnÃ¡lise Descritiva
#**2.1 Medidas de Resumo**
#*********************************
head(dados,10)
summary(dados)
summary(dados[ , c(1:8,10)])
sum(dados$abfunc == 1)
x11()
par(mfrow=c(3,3))
plot(dados$abfunc, xlab = '', ylab = '', main = 'AB Funcionou')
plot(dados$veloc, xlab = '', ylab = '', main = 'Velocidade')
plot(dados$sobrev, xlab = '', ylab = '', main = 'Sobrevivente')
plot(dados$airbag, xlab = '', ylab = '', main = 'Airbag')
plot(dados$cinto, xlab = '', ylab = '', main = 'Cinto')
plot(dados$frontal, xlab = '', ylab = '', main = 'Frontal')
plot(dados$sexo, xlab = '', ylab = '', main = 'Sexo')
#plot(dados$idade, xlab = '', ylab = '', main = 'Idade')
plot(dados$ocupantes, xlab = '', ylab = '', main = 'Ocupante')
plot(dados$grav, xlab = '', ylab = '', main = 'Gravidade') #variavel numerica
mtext(side=2,cex=1.3,line=-1.5,text="Proporção de respostas",outer=TRUE)
x11()
x11()
par(mfrow=c(3,3))
install.packages("C:/Users/Simone/Downloads/hnp_1.2-6.zip", repos = NULL, type = "win.binary")
library(hnp)
library(MASS)
library(hnp)
library(lattice)
library(MASS)
library(DAAG)
library(gridExtra)
library(corrplot)
library(carData)
library(car)
library(statmod)
library(effects)
library(ROCR)
library(hnp)
library(faraway)
library(ggplot2)
library(lattice)
library(MASS)
library(DAAG)
library(gridExtra)
library(corrplot)
library(carData)
library(car)
library(statmod)
library(effects)
library(ROCR)
library(hnp)
library(faraway)
library(ggplot2)
## Carregando e ajustando a base de dados
#*********************************
data("nassCDS")
summary(nassCDS)
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
#selecionando covariáveis
dados <-dados[,c(-2,-9,-10,-11,-15)]
summary(dados)
#ajustando as variáveis
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09',
ifelse(dados$dvcat == '10-24','10-24',
ifelse(dados$dvcat == '25-39','25-39',
ifelse(dados$dvcat == '40-54','40-54','55+')))))
dados$dead <- as.factor(ifelse(dados$dead == 'alive','Sim','Nao'))
dados$airbag <- as.factor(ifelse(dados$airbag == 'airbag','Sim','Nao'))
dados$seatbelt <- as.factor(ifelse(dados$seatbelt == 'belted','Sim','Nao'))
dados$frontal <- as.factor(ifelse(dados$frontal == 1,'Sim','Nao'))
dados$sex <- as.factor(ifelse(dados$sex == 'm', 'Masc','Fem'))
dados$occRole <- as.factor(ifelse(dados$occRole == 'driver','Motorista','Passageiro'))
dados$deploy<-as.factor(ifelse(dados$deploy == 1,'Sim','Nao'))
dados$injSeverity<-as.ordered(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
str(dados)
## Carregando e ajustando a base de dados
#*********************************
data("nassCDS")
summary(nassCDS)
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
#selecionando covariáveis
dados <-dados[,c(-2,-9,-10,-11,-15)]
summary(dados)
#ajustando as variáveis
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09',
ifelse(dados$dvcat == '10-24','10-24',
ifelse(dados$dvcat == '25-39','25-39',
ifelse(dados$dvcat == '40-54','40-54','55+')))))
dados$dead <- as.factor(ifelse(dados$dead == 'alive','Sim','Nao'))
dados$airbag <- as.factor(ifelse(dados$airbag == 'airbag','Sim','Nao'))
dados$seatbelt <- as.factor(ifelse(dados$seatbelt == 'belted','Sim','Nao'))
dados$frontal <- as.factor(ifelse(dados$frontal == 1,'Sim','Nao'))
dados$sex <- as.factor(ifelse(dados$sex == 'm', 'Masc','Fem'))
dados$occRole <- as.factor(ifelse(dados$occRole == 'driver','Motorista','Passageiro'))
dados$deploy<-as.factor(ifelse(dados$deploy == 1,'Sim','Nao'))
dados$injSeverity<-as.ordered(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
str(dados)
par(mfrow = c(3,3))
plot(dados$abfunc, xlab = '', ylab = '', main = 'AB Funcionou')
plot(dados$veloc, xlab = '', ylab = '', main = 'Velocidade')
plot(dados$sobrev, xlab = '', ylab = '', main = 'Sobrevivente')
plot(dados$airbag, xlab = '', ylab = '', main = 'Airbag')
plot(dados$cinto, xlab = '', ylab = '', main = 'Cinto')
plot(dados$frontal, xlab = '', ylab = '', main = 'Frontal')
plot(dados$sexo, xlab = '', ylab = '', main = 'Sexo')
plot(dados$ocupantes, xlab = '', ylab = '', main = 'Ocupante')
plot(dados$grav, xlab = '', ylab = '', main = 'Gravidade')
mtext(side=2,cex=1.3,line=-1.5,text="Frequencias",outer=TRUE)
g1<-ggplot(dados, aes(y=idade)) +
geom_boxplot()+ xlab('idade')+ ylab('') +
theme(legend.title=element_blank())
g1
ajuste1 <- glm(abfunc ~ .,family=binomial(link='logit'),data = dados)
ajuste2 <- glm(abfunc ~ .,family=binomial(link = 'probit'),data = dados)
ajuste3 <- glm(abfunc ~ .,family=binomial(link='cloglog'),data = dados)
ajuste4 <- glm(abfunc ~ .,family=binomial(link='cauchit'),data = dados)
selec <- data.frame(ajuste=c('logito', 'probito', 'cloglog', 'cauchy'),
aic=c(AIC(ajuste1), AIC(ajuste2), AIC(ajuste3), AIC(ajuste4)),
logLik=c(logLik(ajuste1),logLik(ajuste2),logLik(ajuste3),logLik(ajuste4)))
selec
summary(ajuste3)
ajuste3.1 <- step(ajuste3, direction = "both")
summary(ajuste3.1)
anova(ajuste3, ajuste3.1, test = 'Chisq')
par(mfrow=c(2,2))
plot(ajuste3.1, 1:4)
ajuste3.1 <- step(ajuste3, direction = "both")
summary(ajuste3.1)
anova(ajuste3, ajuste3.1, test = 'Chisq')
par(mfrow=c(2,2))
plot(ajuste3.1, 1:4)
plot(ajuste3.1, 1:4)
plot(ajuste3.1, 1:4)
anova(ajuste3, ajuste3.1, test = 'Chisq')
selec <- data.frame(ajuste=c('logito', 'probito', 'cloglog', 'cauchy'),
aic=c(AIC(ajuste1), AIC(ajuste2), AIC(ajuste3), AIC(ajuste4)),
logLik=c(logLik(ajuste1),logLik(ajuste2),logLik(ajuste3),logLik(ajuste4)))
selec
ajuste3.1 <- step(ajuste3, direction = "both")
summary(ajuste3.1)
anova(ajuste3, ajuste3.1, test = 'Chisq')
summary(ajuste3)
selec
anova(ajuste3, ajuste3.1, test = 'Chisq')
selec2 <- data.frame(ajuste=c('aj3', 'aj3.1'),
aic=c(AIC(ajuste3), AIC(ajuste3.1)),
logLik=c(logLik(ajuste3),logLik(ajuste3.1)),
Dev=c(deviance(ajuste3),deviance(ajuste3.1)))
selec2
anova(ajuste3, ajuste3.1, test = 'Chisq')
plot(ajuste3, 1:4)
par(mfrow=c(2,2))
plot(ajuste3, 1:4)
hnp(ajuste3)
hnp(ajuste3.1)
par(mfrow=c(1,2))
hnp(ajuste3)
hnp(ajuste3.1)
ajuste1 <- glm(abfunc ~ .,family=binomial(link='logit'),data = dados)
summary(ajuste3)
levels(dados$veloc)
str(dados)
## Carregando e ajustando a base de dados
#*********************************
data("nassCDS")
summary(nassCDS)
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
#selecionando covariáveis
dados <-dados[,c(-2,-9,-10,-11,-15)]
summary(dados)
#ajustando as variáveis
dados$dvcat <- as.factor(ifelse(dados$dvcat == '1-9km/h','01-09',
ifelse(dados$dvcat == '10-24','10-24',
ifelse(dados$dvcat == '25-39','25-39',
ifelse(dados$dvcat == '40-54','40-54','55+')))))
dados$dead <- as.factor(ifelse(dados$dead == 'alive','Sim','Nao'))
dados$airbag <- as.factor(ifelse(dados$airbag == 'airbag','Sim','Nao'))
dados$seatbelt <- as.factor(ifelse(dados$seatbelt == 'belted','Sim','Nao'))
dados$frontal <- as.factor(ifelse(dados$frontal == 1,'Sim','Nao'))
dados$sex <- as.factor(ifelse(dados$sex == 'm', 'Masc','Fem'))
dados$occRole <- as.factor(ifelse(dados$occRole == 'driver','Motorista','Passageiro'))
dados$deploy<-as.factor(ifelse(dados$deploy == 1,'Sim','Nao'))
dados$injSeverity<-as.factor(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
str(dados)
head(dados,10)
summary(dados)
summary(dados[ , c(1:8,10)])
sum(dados$abfunc == 'SIM')
summary(dados[ , c(1:8,10)])
ajuste1 <- glm(abfunc ~ .,family=binomial(link='logit'),data = dados)
ajuste2 <- glm(abfunc ~ .,family=binomial(link = 'probit'),data = dados)
ajuste3 <- glm(abfunc ~ .,family=binomial(link='cloglog'),data = dados)
ajuste4 <- glm(abfunc ~ .,family=binomial(link='cauchit'),data = dados)
selec <- data.frame(ajuste=c('logito', 'probito', 'cloglog', 'cauchy'),
aic=c(AIC(ajuste1), AIC(ajuste2), AIC(ajuste3), AIC(ajuste4)),
logLik=c(logLik(ajuste1),logLik(ajuste2),logLik(ajuste3),logLik(ajuste4)))
selec
summary(ajuste3)
levels(dados$veloc)
summary(ajuste3)
anova(ajuste3, ajuste3.1, test = 'Chisq')
head(dados,10)
summary(dados)
summary(dados[ , c(1:8,10)])
sum(dados$abfunc == 'SIM')
summary(dados[ , c(1:8,10)])
help("logLik"  )
summary(ajuste3)
