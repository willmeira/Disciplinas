dados$airbag<-as.factor(dados$airbag)
dados$seatbelt<-as.factor(dados$seatbelt)
dados$frontal<-as.factor(dados$frontal)
dados$sex<-as.factor(dados$sex)
dados$occRole<-as.factor(dados$occRole)
dados$deploy<-as.factor(dados$deploy)
dados$injSeverity<-as.factor(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
str(dados)
summary(dados[ , c(1:8,10)])
################################################### tabelas para gráficos de setor
table(dados$veloc)
################################################### tabelas para gráficos de setor
pie(table(dados$veloc))
################################################### tabelas para gráficos de setor
pie(table(dados$veloc),labels = TRUE)
data("nassCDS")
dados <- nassCDS
summary(dados)
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
dados <-dados[,c(-2,-9,-10,-11,-15)]
dados$dvcat <- ifelse(dados$dvcat == '1-9km/h','01-09 km/h',
ifelse(dados$dvcat == '10-24','10-24 km/h',
ifelse(dados$dvcat == '25-39','25-39 km/h',
ifelse(dados$dvcat == '40-54','40-54 km/h','+55 km/h'))))
dados$dead <- ifelse(dados$dead == 'alive', 1, 0)
dados$airbag <- ifelse(dados$airbag == 'airbag',1,0)
dados$seatbelt <- ifelse(dados$seatbelt == 'belted',1,0)
dados$sex <- ifelse(dados$sex == 'm', 1, 0)
dados$dvcat<-as.factor(dados$dvcat)
dados$dead<-as.factor(dados$dead)
dados$airbag<-as.factor(dados$airbag)
dados$seatbelt<-as.factor(dados$seatbelt)
dados$frontal<-as.factor(dados$frontal)
dados$sex<-as.factor(dados$sex)
dados$occRole<-as.factor(dados$occRole)
dados$deploy<-as.factor(dados$deploy)
dados$injSeverity<-as.factor(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
str(dados)
aux<-table(dados$veloc)/sum(table(dados$veloc))
aux
aux<-table(dados$veloc)/sum(table(dados$veloc))*100
aux
aux<-(table(dados$veloc)/sum(table(dados$veloc)))*100
aux
aux<-round(table(dados$veloc)/sum(table(dados$veloc)))*100,2)
aux<-round((table(dados$veloc)/sum(table(dados$veloc)))*100,2)
aux
aux<-paste0(round((table(dados$veloc)/sum(table(dados$veloc)))*100,2),' %')
aux
names(table(dados$veloc))
paste0(names(table(dados$veloc)),' 'aux)
paste0(names(table(dados$veloc)),' ',aux)
pie(table(dados$veloc),labels = aux)
x11()
par(mfrow=c(4,3), las=1)
plot(dados$abfunc, xlab = '', ylab = '', main = 'AB Funcionou')
plot(dados$veloc, xlab = '', ylab = '', main = 'Velocidade')
plot(dados$sobrev, xlab = '', ylab = '', main = 'Sobrevivente')
plot(dados$airbag, xlab = '', ylab = '', main = 'Airbag')
plot(dados$cinto, xlab = '', ylab = '', main = 'Cinto')
plot(dados$frontal, xlab = '', ylab = '', main = 'Frontal')
plot(dados$sexo, xlab = '', ylab = '', main = 'Sexo')
plot(dados$idade, xlab = '', ylab = '', main = 'Idade') ### ******* inverteu eixo
plot(dados$ocupantes, xlab = '', ylab = '', main = 'Ocupante')
plot(dados$grav, xlab = '', ylab = '', main = 'Gravidade')
x11()
plot(dados$veloc, xlab = '', ylab = '', main = 'Velocidade')
data("nassCDS")
dados <- nassCDS
str(dados)
levels(dados$dvcat)
dados$dvcat <- ifelse(dados$dvcat == '1-9km/h','01-09 km/h',
ifelse(dados$dvcat == '10-24','10-24 km/h',
ifelse(dados$dvcat == '25-39','25-39 km/h',
ifelse(dados$dvcat == '40-54','40-54 km/h','+55 km/h'))))
levels(dados$dvcat)
levels(dados$dvcat)
str(dados)
data("nassCDS")
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
dados <-dados[,c(-2,-9,-10,-11,-15)]
dados$dvcat <- as.factor(ifelse(dados$dvcat == '1-9km/h','01-09 km/h',
ifelse(dados$dvcat == '10-24','10-24 km/h',
ifelse(dados$dvcat == '25-39','25-39 km/h',
ifelse(dados$dvcat == '40-54','40-54 km/h','+55 km/h')))))
levels(dados$dvcat)
str(dados)
data("nassCDS")
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
dados <-dados[,c(-2,-9,-10,-11,-15)]
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09 km/h',
ifelse(dados$dvcat == '10-24','10-24 km/h',
ifelse(dados$dvcat == '25-39','25-39 km/h',
ifelse(dados$dvcat == '40-54','40-54 km/h','+55 km/h')))))
str(dados)
levels(dados$dvcat)
data("nassCDS")
dados <- nassCDS
summary(dados)
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
dados <-dados[,c(-2,-9,-10,-11,-15)]
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09 km/h',
ifelse(dados$dvcat == '10-24','10-24 km/h',
ifelse(dados$dvcat == '25-39','25-39 km/h',
ifelse(dados$dvcat == '40-54','40-54 km/h','55+ km/h')))))
levels(dados$dvcat)
dados$dead <- ifelse(dados$dead == 'alive', 1, 0)
dados$airbag <- ifelse(dados$airbag == 'airbag',1,0)
dados$seatbelt <- ifelse(dados$seatbelt == 'belted',1,0)
dados$sex <- ifelse(dados$sex == 'm', 1, 0)
#dados$dvcat<-as.factor(dados$dvcat)
dados$dead<-as.factor(dados$dead)
dados$airbag<-as.factor(dados$airbag)
dados$seatbelt<-as.factor(dados$seatbelt)
dados$frontal<-as.factor(dados$frontal)
dados$sex<-as.factor(dados$sex)
dados$occRole<-as.factor(dados$occRole)
dados$deploy<-as.factor(dados$deploy)
dados$injSeverity<-as.factor(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
str(dados)
pie(table(dados$veloc),labels = aux)
aux<-paste0(round((table(dados$veloc)/sum(table(dados$veloc)))*100,2),' %')
paste0(names(table(dados$veloc)),' 'aux)
pie(table(dados$veloc),labels = aux)
plot(dados$veloc, xlab = '', ylab = '', main = 'Velocidade')
data("nassCDS")
dados <- nassCDS
summary(dados)
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
dados <-dados[,c(-2,-9,-10,-11,-15)]
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09 mph',
ifelse(dados$dvcat == '10-24','10-24 mph',
ifelse(dados$dvcat == '25-39','25-39 mph',
ifelse(dados$dvcat == '40-54','40-54 mph','55+ mph')))))
dados$dead <- as.factor(ifelse(dados$dead == 'alive', 1, 0))
dados$airbag <- as.factor(ifelse(dados$airbag == 'airbag',1,0))
dados$seatbelt <- as.factor(ifelse(dados$seatbelt == 'belted',1,0))
dados$sex <- as.factor(ifelse(dados$sex == 'm', 1, 0))
dados$frontal<-as.factor(dados$frontal)
dados$occRole<-as.factor(dados$occRole)
dados$deploy<-as.factor(dados$deploy)
dados$injSeverity<-as.factor(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
str(dados)
aux<-paste0(round((table(dados$veloc)/sum(table(dados$veloc)))*100,2),' %')
aux
aux<-paste0(round((table(dados$veloc)/sum(table(dados$veloc)))*100,2),'%')
aux
aux<-paste0(round((table(dados$veloc)/sum(table(dados$veloc)))*100,1),'%')
aux
paste0(names(table(dados$veloc)),' 'aux)
paste0(names(table(dados$veloc)),' ',aux)
pie(table(dados$veloc),labels = paste0(names(table(dados$veloc)),' ',aux))
pie(table(dados$veloc),labels = paste0(names(table(dados$veloc)),' - ',aux))
x11()
par(mfrow=c(4,3), las=1)
plot(dados$abfunc, xlab = '', ylab = '', main = 'AB Funcionou')
plot(dados$veloc, xlab = '', ylab = '', main = 'Velocidade')
plot(dados$sobrev, xlab = '', ylab = '', main = 'Sobrevivente')
plot(dados$airbag, xlab = '', ylab = '', main = 'Airbag')
plot(dados$cinto, xlab = '', ylab = '', main = 'Cinto')
plot(dados$frontal, xlab = '', ylab = '', main = 'Frontal')
plot(dados$sexo, xlab = '', ylab = '', main = 'Sexo')
plot(dados$idade, xlab = '', ylab = '', main = 'Idade') ### ******* inverteu eixo
plot(dados$ocupantes, xlab = '', ylab = '', main = 'Ocupante')
plot(dados$grav, xlab = '', ylab = '', main = 'Gravidade')
plot(cons~estr, data = dados, xlab = 'Estrada', ylab = 'Consumo')
abline(lm(cons~estr, data = dados), col = 2, lwd = 2)
par(mfrow = c(2,2))
x11()
plot(abfunc~veloc, data = dados, xlab = 'Taxa', ylab = 'Consumo')
boxplot(dados$idade~dados$abfunc)
boxplot(dados$idade~dados$abfunc,xlab = '', ylab = 'Idade', main = 'Idade'))
boxplot(dados$idade~dados$abfunc,xlab = '', ylab = 'Idade', main = 'Idade')
x11()
par(mfrow=c(4,3), las=1)
pie(table(dados$abfunc)
aux<-paste0(round((table(dados$veloc)/sum(table(dados$veloc)))*100,1),'%')
pie(table(dados$veloc),labels = paste0(names(table(dados$veloc)),' - ',aux))
pie(table(dados$sobrev)
pie(table(dados$airbag)
pie(table(dados$cinto)
pie(table(dados$frontal)
pie(table(dados$sexo)
pie(table(dados$idade)
pie(table(dados$ocupantes)
pie(table(dados$grav)
data("nassCDS")
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
#selecionando covariáveis
dados <-dados[,c(-2,-9,-10,-11,-15)]
#ajustando as variáveis
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09 mph',
ifelse(dados$dvcat == '10-24','10-24 mph',
ifelse(dados$dvcat == '25-39','25-39 mph',
ifelse(dados$dvcat == '40-54','40-54 mph','55+ mph')))))
dados$dead <- as.factor(ifelse(dados$dead == 'alive', 1, 0))
dados$airbag <- as.factor(ifelse(dados$airbag == 'airbag',1,0))
dados$seatbelt <- as.factor(ifelse(dados$seatbelt == 'belted',1,0))
dados$sex <- as.factor(ifelse(dados$sex == 'm', 1, 0))
dados$frontal<-as.factor(dados$frontal)
dados$occRole<-as.factor(dados$occRole)
dados$deploy<-as.factor(dados$deploy)
dados$injSeverity<-as.factor(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
str(dados)
head(dados,10)
summary(dados)
summary(dados[ , c(1:8,10)])
################################################### tabelas para gráficos de setor
x11()
par(mfrow=c(4,3), las=1)
pie(table(dados$abfunc)
pie(table(dados$abfunc))
################################################### tabelas para gráficos de setor
x11()
par(mfrow=c(4,3), las=1)
pie(table(dados$abfunc))
pie(table(dados$veloc))
pie(table(dados$sobrev))
pie(table(dados$airbag))
pie(table(dados$cinto))
pie(table(dados$frontal))
pie(table(dados$sexo))
pie(table(dados$idade))
pie(table(dados$ocupantes))
pie(table(dados$grav))
x11()
par(mfrow=c(4,3), las=1)
pie(table(dados$abfunc), main = 'AB Funcionou')
pie(table(dados$veloc), main = 'Velocidade')
pie(table(dados$sobrev), main = 'Sobrevivente')
pie(table(dados$airbag), main = 'Airbag')
pie(table(dados$cinto), main = 'Cinto')
pie(table(dados$frontal), main = 'Frontal')
pie(table(dados$sexo), main = 'Sexo'
pie(table(dados$idade), main = 'Idade')
pie(table(dados$ocupantes), main = 'Ocupante')
pie(table(dados$grav), main = 'Gravidade')
pie(table(dados$sexo), main = 'Sexo')
x11()
par(mfrow=c(4,3), las=1)
pie(table(dados$abfunc), main = 'AB Funcionou')
pie(table(dados$veloc), main = 'Velocidade')
pie(table(dados$sobrev), main = 'Sobrevivente')
pie(table(dados$airbag), main = 'Airbag')
pie(table(dados$cinto), main = 'Cinto')
pie(table(dados$frontal), main = 'Frontal')
pie(table(dados$sexo), main = 'Sexo')
pie(table(dados$idade), main = 'Idade')
pie(table(dados$ocupantes), main = 'Ocupante')
pie(table(dados$grav), main = 'Gravidade')
x11()
par(mfrow=c(4,3), las=1)
plot(dados$abfunc, xlab = '', ylab = '', main = 'AB Funcionou')
plot(dados$veloc, xlab = '', ylab = '', main = 'Velocidade')
plot(dados$sobrev, xlab = '', ylab = '', main = 'Sobrevivente')
plot(dados$airbag, xlab = '', ylab = '', main = 'Airbag')
plot(dados$cinto, xlab = '', ylab = '', main = 'Cinto')
plot(dados$frontal, xlab = '', ylab = '', main = 'Frontal')
plot(dados$sexo, xlab = '', ylab = '', main = 'Sexo')
#plot(dados$idade, xlab = '', ylab = '', main = 'Idade') ### ******* inverteu eixo
boxplot(dados$idade, xlab = '', ylab = '', main = 'Thick', las=1)
plot(dados$ocupantes, xlab = '', ylab = '', main = 'Ocupante')
plot(dados$grav, xlab = '', ylab = '', main = 'Gravidade')
#plot(dados$idade, xlab = '', ylab = '', main = 'Idade') ### ******* inverteu eixo
boxplot(dados$idade, xlab = '', ylab = '', main = 'Thick', las=1)
boxplot(dados$idade~dados$abfunc,xlab = '', ylab = 'Idade', main = 'Idade')
x11()
par(mfrow=c(4,3), las=1)
plot(dados$abfunc, xlab = '', ylab = '', main = 'AB Funcionou')
plot(dados$veloc, xlab = '', ylab = '', main = 'Velocidade')
plot(dados$sobrev, xlab = '', ylab = '', main = 'Sobrevivente')
plot(dados$airbag, xlab = '', ylab = '', main = 'Airbag')
plot(dados$cinto, xlab = '', ylab = '', main = 'Cinto')
plot(dados$frontal, xlab = '', ylab = '', main = 'Frontal')
plot(dados$sexo, xlab = '', ylab = '', main = 'Sexo')
#plot(dados$idade, xlab = '', ylab = '', main = 'Idade') ### ******* inverteu eixo
boxplot(dados$idade~dados$abfunc,xlab = '', ylab = 'Idade', main = 'Idade')
plot(dados$ocupantes, xlab = '', ylab = '', main = 'Ocupante')
plot(dados$grav, xlab = '', ylab = '', main = 'Gravidade')
library(DAAG)
library(gridExtra)
library(corrplot)
library(car)
library(statmod)
library(effects)
library(gplots)
library(gtools)
library(gdata)
library(ROCR)
library(faraway)
library(ggplot2)
library(hnp)
#*********************************
## Carregando e ajustando a base de dados
#*********************************
data("nassCDS")
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
#selecionando covariáveis
dados <-dados[,c(-2,-9,-10,-11,-15)]
#ajustando as variáveis
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09 mph',
ifelse(dados$dvcat == '10-24','10-24 mph',
ifelse(dados$dvcat == '25-39','25-39 mph',
ifelse(dados$dvcat == '40-54','40-54 mph','55+ mph')))))
str(dados)
data("nassCDS")
dados <- nassCDS
summary(dados)
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
dados <-dados[,c(-2,-9,-10,-11,-15)]
dados$dvcat <- ifelse(dados$dvcat == '1-9km/h','01-09',
ifelse(dados$dvcat == '10-24','10-24',
ifelse(dados$dvcat == '25-39','25-39',
ifelse(dados$dvcat == '40-54','40-54','55+'))))
dados$dead <- ifelse(dados$dead == 'alive', 1, 0)
dados$airbag <- ifelse(dados$airbag == 'airbag',1,0)
dados$seatbelt <- ifelse(dados$seatbelt == 'belted',1,0)
dados$sex <- ifelse(dados$sex == 'm', 1, 0)
dados$dvcat<-as.factor(dados$dvcat)
dados$dead<-as.factor(dados$dead)
dados$airbag<-as.factor(dados$airbag)
dados$seatbelt<-as.factor(dados$seatbelt)
dados$frontal<-as.factor(dados$frontal)
dados$sex<-as.factor(dados$sex)
dados$occRole<-as.factor(dados$occRole)
dados$deploy<-as.factor(dados$deploy)
dados$injSeverity<-as.factor(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
str(dados)
# pacotes necessários
library(DAAG)
library(gridExtra)
library(corrplot)
library(car)
library(statmod)
library(effects)
library(gplots)
library(gtools)
library(gdata)
library(ROCR)
library(faraway)
library(ggplot2)
library(hnp)
install.packages("effects")
install.packages("~/Documentos/Will Meira/GitHub/effects_4.0-3.tar.gz", repos = NULL, type = "source")
data("nassCDS")
dados <- nassCDS
summary(dados)
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
dados <-dados[,c(-2,-9,-10,-11,-15)]
dados$dvcat <- ifelse(dados$dvcat == '1-9km/h','01-09',
ifelse(dados$dvcat == '10-24','10-24',
ifelse(dados$dvcat == '25-39','25-39',
ifelse(dados$dvcat == '40-54','40-54','55+'))))
dados$dead <- ifelse(dados$dead == 'alive', 1, 0)
dados$airbag <- ifelse(dados$airbag == 'airbag',1,0)
dados$seatbelt <- ifelse(dados$seatbelt == 'belted',1,0)
dados$sex <- ifelse(dados$sex == 'm', 1, 0)
dados$dvcat<-as.factor(dados$dvcat)
dados$dead<-as.factor(dados$dead)
dados$airbag<-as.factor(dados$airbag)
dados$seatbelt<-as.factor(dados$seatbelt)
dados$frontal<-as.factor(dados$frontal)
dados$sex<-as.factor(dados$sex)
dados$occRole<-as.factor(dados$occRole)
dados$deploy<-as.factor(dados$deploy)
dados$injSeverity<-as.factor(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
str(dados)
#******************************
ajuste1 <- glm(Class ~ .,family=binomial(link='logit'),data = dados)
#******************************
ajuste1 <- glm(abfunc ~ .,family=binomial(link='logit'),data = dados)
ajuste2 <- glm(abfunc ~ .,family=binomial(link = 'probit'),data = dados)
ajuste3 <- glm(abfunc ~ .,family=binomial(link='cloglog'),data = dados)
ajuste4 <- glm(abfunc ~ .,family=binomial(link='cauchit'),data = dados)
summary(ajuste1)
summary(ajuste2)
summary(ajuste3)
summary(ajuste4)
ajuste11 <- glm(abfunc ~ .,family=binomial(link='logit'),data = dados)
ajuste21 <- glm(abfunc ~ .,family=binomial(link = 'probit'),data = dados)
ajuste31 <- glm(abfunc ~ .,family=binomial(link='cloglog'),data = dados)
ajuste41 <- glm(abfunc ~ .,family=binomial(link='cauchit'),data = dados)
summary(ajuste11)
summary(ajuste21)
summary(ajuste31)
summary(ajuste41)
data("nassCDS")
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
#selecionando covariáveis
dados <-dados[,c(-2,-9,-10,-11,-15)]
#ajustando as variáveis
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09 mph',
ifelse(dados$dvcat == '10-24','10-24 mph',
ifelse(dados$dvcat == '25-39','25-39 mph',
ifelse(dados$dvcat == '40-54','40-54 mph','55+ mph')))))
str(dados)
library(DAAG)
library(gridExtra)
library(corrplot)
library(car)
library(statmod)
library(effects)
library(gplots)
library(gtools)
library(gdata)
library(ROCR)
library(faraway)
library(ggplot2)
library(hnp)
data("nassCDS")
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
#selecionando covariáveis
dados <-dados[,c(-2,-9,-10,-11,-15)]
#ajustando as variáveis
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09 mph',
ifelse(dados$dvcat == '10-24','10-24 mph',
ifelse(dados$dvcat == '25-39','25-39 mph',
ifelse(dados$dvcat == '40-54','40-54 mph','55+ mph')))))
dados$dead <- as.factor(ifelse(dados$dead == 'alive','Sim','Não'))
dados$airbag <- as.factor(ifelse(dados$airbag == 'airbag','Sim','Não'))
dados$seatbelt <- as.factor(ifelse(dados$seatbelt == 'belted','Sim','Não'))
dados$frontal <- as.factor(ifelse(dados$frontal == 1,'Sim','Não'))
dados$sex <- as.factor(ifelse(dados$sex == 'm', 'Masc','Fem'))
dados$occRole <- as.factor(ifelse(dados$occRole == 'driver','Driver','Pass'))
dados$deploy<-as.factor(ifelse(ddados$deploy == 1,'Sim','Não')
dados$injSeverity<-as.ordered(dados$injSeverity)
data("nassCDS")
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
#selecionando covariáveis
dados <-dados[,c(-2,-9,-10,-11,-15)]
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09 mph',
ifelse(dados$dvcat == '10-24','10-24 mph',
ifelse(dados$dvcat == '25-39','25-39 mph',
ifelse(dados$dvcat == '40-54','40-54 mph','55+ mph')))))
dados$dead <- as.factor(ifelse(dados$dead == 'alive','Sim','Não'))
dados$airbag <- as.factor(ifelse(dados$airbag == 'airbag','Sim','Não'))
dados$seatbelt <- as.factor(ifelse(dados$seatbelt == 'belted','Sim','Não'))
dados$frontal <- as.factor(ifelse(dados$frontal == 1,'Sim','Não'))
dados$sex <- as.factor(ifelse(dados$sex == 'm', 'Masc','Fem'))
dados$occRole <- as.factor(ifelse(dados$occRole == 'driver','Driver','Pass'))
dados$deploy<-as.factor(ifelse(ddados$deploy == 1,'Sim','Não'))
dados$injSeverity<-as.ordered(dados$injSeverity)
data("nassCDS")
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
#selecionando covariáveis
dados <-dados[,c(-2,-9,-10,-11,-15)]
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09 mph',
ifelse(dados$dvcat == '10-24','10-24 mph',
ifelse(dados$dvcat == '25-39','25-39 mph',
ifelse(dados$dvcat == '40-54','40-54 mph','55+ mph')))))
dados$dead <- as.factor(ifelse(dados$dead == 'alive','Sim','Não'))
dados$airbag <- as.factor(ifelse(dados$airbag == 'airbag','Sim','Não'))
dados$seatbelt <- as.factor(ifelse(dados$seatbelt == 'belted','Sim','Não'))
dados$frontal <- as.factor(ifelse(dados$frontal == 1,'Sim','Não'))
dados$sex <- as.factor(ifelse(dados$sex == 'm', 'Masc','Fem'))
dados$occRole <- as.factor(ifelse(dados$occRole == 'driver','Driver','Pass'))
dados$deploy<-as.factor(ifelse(dados$deploy == 1,'Sim','Não'))
dados$injSeverity<-as.ordered(dados$injSeverity)
str(dados)
summary(dados)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
str(dados)
install.packages("~/Documentos/Will Meira/GitHub/effects_4.0-3.tar.gz", repos = NULL, type = "source")
str(dados)
ajuste1 <- glm(abfunc ~ .,family=binomial(link='logit'),data = dados)
ajuste2 <- glm(abfunc ~ .,family=binomial(link = 'probit'),data = dados)
ajuste3 <- glm(abfunc ~ .,family=binomial(link='cloglog'),data = dados)
ajuste4 <- glm(abfunc ~ .,family=binomial(link='cauchit'),data = dados)
summary(ajuste1)
summary(ajuste2)
summary(ajuste3)
summary(ajuste4)
selec <- data.frame(ajuste=c('logito', 'probito', 'cloglog', 'cauchy'),
aic=c(AIC(ajuste11), AIC(ajuste21), AIC(ajuste31), AIC(ajuste41)),
logLik=c(logLik(ajuste11),logLik(ajuste21),logLik(ajuste31),logLik(ajuste41)))
selec2 <- data.frame(ajuste=c('logito', 'probito', 'cloglog', 'cauchy'),
aic=c(AIC(ajuste11), AIC(ajuste21), AIC(ajuste31), AIC(ajuste41)),
logLik=c(logLik(ajuste11),logLik(ajuste21),logLik(ajuste31),logLik(ajuste41)))
selec2
selec <- data.frame(ajuste=c('logito', 'probito', 'cloglog', 'cauchy'),
aic=c(AIC(ajuste1), AIC(ajuste2), AIC(ajuste3), AIC(ajuste4)),
logLik=c(logLik(ajuste1),logLik(ajuste2),logLik(ajuste3),logLik(ajuste4)))
selec
selec2
x11()
par(mfrow=c(4,3), las=1)
plot(dados$abfunc, xlab = '', ylab = '', main = 'AB Funcionou')
plot(dados$veloc, xlab = '', ylab = '', main = 'Velocidade')
plot(dados$sobrev, xlab = '', ylab = '', main = 'Sobrevivente')
plot(dados$airbag, xlab = '', ylab = '', main = 'Airbag')
plot(dados$cinto, xlab = '', ylab = '', main = 'Cinto')
plot(dados$frontal, xlab = '', ylab = '', main = 'Frontal')
plot(dados$sexo, xlab = '', ylab = '', main = 'Sexo')
#plot(dados$idade, xlab = '', ylab = '', main = 'Idade') ### ******* inverteu eixo
boxplot(dados$idade~dados$abfunc,xlab = '', ylab = 'Idade', main = 'Idade')
plot(dados$ocupantes, xlab = '', ylab = '', main = 'Ocupante')
plot(dados$grav, xlab = '', ylab = '', main = 'Gravidade')
