require(car)
require(MASS)
require(faraway)
require(effects)
options(scipen = 5)
head(Chile)
summary(Chile)
Chile2$vote <- factor(Chile2$vote)
Chile2 <- Chile[which(Chile$vote%in%c('N','Y')),]
Chile2$vote <- factor(Chile2$vote)
summary(Chile2)
library(DAAG)
library(gridExtra)
library(corrplot)
library(car)
library(statmod)
library(effects)
library(gplots)
library(gtools)
library(gdata)
library(ROCR)
library(faraway)
library(ggplot2)
library(hnp)
library(effects)
# pacotes necessÃ¡rios
library(DAAG)
library(gridExtra)
library(corrplot)
library(car)
library(statmod)
library(effects)
library(gplots)
library(gtools)
library(gdata)
library(ROCR)
library(faraway)
library(ggplot2)
library(hnp)
#*********************************
## Carregando e ajustando a base de dados
## 1. Descrição dos dados
#*********************************
data("nassCDS")
dados <- nassCDS
dados<-subset(dados,yearacc==2002 & yearVeh == 2000)
#selecionando covariÃ¡veis
dados <-dados[,c(-2,-9,-10,-11,-15)]
#ajustando as variÃ¡veis
dados$dvcat <- as.ordered(ifelse(dados$dvcat == '1-9km/h','01-09 mph',
ifelse(dados$dvcat == '10-24','10-24 mph',
ifelse(dados$dvcat == '25-39','25-39 mph',
ifelse(dados$dvcat == '40-54','40-54 mph','55+ mph')))))
dados$dead <- as.numeric(ifelse(dados$dead == 'alive',1,0))
dados$airbag <- as.numeric(ifelse(dados$airbag == 'airbag',1,0))
dados$seatbelt <- as.numeric(ifelse(dados$seatbelt == 'belted',1,0))
dados$frontal <- as.numeric(ifelse(dados$frontal == 1,1,0))
dados$sex <- as.factor(ifelse(dados$sex == 'm', 'Masc','Fem'))
dados$occRole <- as.numeric(ifelse(dados$occRole == 'driver',1,0))
dados$deploy<-as.factor(ifelse(dados$deploy == 1,'Sim','Não'))
dados$injSeverity<-as.ordered(dados$injSeverity)
names(dados)<-c('veloc','sobrev','airbag','cinto','frontal','sexo','idade','ocupantes','abfunc','grav')
#*********************************
## AnÃ¡lise Descritiva
#**2.1 Medidas de Resumo**
#*********************************
head(dados,10)
summary(dados)
summary(dados[ , c(1:8,10)])
sum(dados$abfunc == 1)
x11()
par(mfrow=c(3,3))
plot(dados$abfunc, xlab = '', ylab = '', main = 'AB Funcionou')
plot(dados$veloc, xlab = '', ylab = '', main = 'Velocidade')
plot(dados$sobrev, xlab = '', ylab = '', main = 'Sobrevivente')
plot(dados$airbag, xlab = '', ylab = '', main = 'Airbag')
plot(dados$cinto, xlab = '', ylab = '', main = 'Cinto')
plot(dados$frontal, xlab = '', ylab = '', main = 'Frontal')
plot(dados$sexo, xlab = '', ylab = '', main = 'Sexo')
#plot(dados$idade, xlab = '', ylab = '', main = 'Idade')
plot(dados$ocupantes, xlab = '', ylab = '', main = 'Ocupante')
plot(dados$grav, xlab = '', ylab = '', main = 'Gravidade') #variavel numerica
mtext(side=2,cex=1.3,line=-1.5,text="Proporção de respostas",outer=TRUE)
x11()
x11()
par(mfrow=c(3,3))
