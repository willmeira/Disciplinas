barplot(tabela)
modelo1 <- gamlss(doctorco ~ sex + age + agesq
+ income + levyplus + illness + actdays + chcond1 + hospadmi
+ medicine, family = PO, data = dvisits)
plot(modelo1)
X11()
plot(modelo1)
x11()
plot(modelo1)
modelo2 <- gamlss(doctorco ~ sex + age + agesq + income + levyplus + illness +
actdays + chcond1 + hospadmi + medicine, family = NBI,
data = dvisits)
x11()
plot(modelo2)
modelo3 <- gamlss(doctorco ~ sex + age + agesq + income + levyplus + illness +
actdays + chcond1 + hospadmi + medicine,
family = ZIP, data = dvisits)
plot(modelo3)
modelo4 <- gamlss(doctorco ~ sex + age + agesq + income + levyplus + illness +
actdays + chcond1 + hospadmi + medicine,
family = ZINBI, data = dvisits)
plot(modelo4)
modelo5 <- gamlss(doctorco ~ sex + age + agesq + income + levyplus + illness +
actdays + chcond1 + hospadmi + medicine,
sigma.formula = ~ sex + age + agesq + income + levyplus +
illness + actdays + chcond1 + hospadmi + medicine,
family = ZIP, data = dvisits)
plot(modelo5)
modelo6 <- gamlss(doctorco ~ sex + age + agesq + income + levyplus + illness +
actdays + chcond1 + hospadmi + medicine,
nu.formula = ~ sex + age + agesq + income + levyplus +
illness + actdays + chcond1 + hospadmi + medicine,
family = ZINBI, data = dvisits)
plot(modelo6)
AIC(modelo1, modelo2, modelo3, modelo4, modelo5, modelo6)
summary(modelo6)
modelo7 <- gamlss(doctorco ~ actdays + hospadmi + medicine,
nu.formula = ~ sex + age + agesq +illness + actdays + medicine,
family = ZINBI, data = dvisits)
LR.test(modelo7, modelo6) ### Comparando os modelos via teste da razão de verossimilhanças.
plot(modelo7)
summary(modelo7)
m1<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=PO, data=dados)
# Ajuste Glm Poisson
m2<-glm(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
# Ajuste Glm.nb
m3<-glm.nb(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, data=dados)
# Ajuste Gamlss NBI
m4<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBI, data=dados)
# Ajuste Gamlss NBII
m5<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBII, data=dados)
# Ajuste Gamlss NBF
m6<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBF, data=dados)
Ajuste = c('mod1','mod2','mod3','mod4','mod5','mod6')
Dev    = c(deviance(m1),deviance(m2),deviance(m3),
deviance(m4),deviance(m5),deviance(m6))
AIC    = c(AIC(m1),AIC(m2),AIC(m3),AIC(m4),AIC(m5),AIC(m6))
MaxVer = c(logLik(m1),logLik(m2),logLik(m3),
logLik(m4),logLik(m5),logLik(m6))
data.frame(Ajuste, Dev, AIC, MaxVer)
# Ajuste Glm Poisson offset
m2.1<-glm(obit~vphab+log(dens)+purb+palf+pdes+rmed+offset(idh), family=poisson(link='log'),data=dados)
summary(m2.1)
m2.2<-glm(obit~vphab+log(dens)+purb+palf+pdes+offset(rmed)+idh, family=poisson(link='log'),data=dados)
summary(m2.2)
m2.2<-glm(obit~vphab+log(dens)+purb+palf+pdes+offset(rmed)+idh, family=poisson(link='log'),data=dados)
m2.2<-glm(obit~vphab+log(dens)+purb+palf+pdes+idh+offset(rmed), family=poisson(link='log'),data=dados)
# Ajuste Glm Poisson
m2<-glm(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
# Ajuste Glm Poisson offset
m2.1<-glm(obit~vphab+log(dens)+purb+palf+pdes+rmed+offset(idh), family=poisson(link='log'),data=dados)
summary(m2.1)
m2.2<-glm(obit~vphab+log(dens)+purb+palf+pdes+idh+offset(rmed), family=poisson(link='log'),data=dados)
m2.2<-glm(obit~vphab+log(dens)+purb+palf+pdes+offset(rmed)+idh, family=poisson(link='log'),data=dados)
# Ajuste Glm Poisson offset
m2.1<-glm(obit~vphab+log(dens)+purb+palf+pdes+rmed+offset(idh), family=poisson(link='log'),data=dados)
m2.2<-glm(obit~vphab+log(dens)+purb+palf+pdes+offset(rmed)+idh, family=poisson(link='log'),data=dados)
m2.2<-glm(obit~vphab+log(dens)+purb+palf+offset(pdes)+rmed+idh, family=poisson(link='log'),data=dados)
summary(m2.2)
m2.2<-glm(obit~vphab+log(dens)+purb+palf+offset(pdes)+rmed+offset(idh), family=poisson(link='log'),data=dados)
summary(m2.2)
m2.2<-glm(obit~vphab+log(dens)+purb+palf+offset(pdes)+rmed+idh, family=poisson(link='log'),data=dados)
m2.3<-glm(obit~vphab+log(dens)+purb+offset(palf)+pdes+rmed+idh, family=poisson(link='log'),data=dados)
summary(m2.3)
m2.3<-glm(obit~vphab+log(dens)+offset(purb)+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
summary(m2.3)
m2.3<-glm(obit~vphab+log(dens)+offset(purb)+offset(palf)+pdes+rmed+idh, family=poisson(link='log'),data=dados)
summary(m2.3)
m2.5<-glm(obit~vphab+offset(log(dens))+purb+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
summary(m2.5)
m2.6<-glm(obit~offset(vphab)+log(dens)+purb+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
m2.6<-glm(obit~offset(vphab)+log(dens)+purb+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
m2.5<-glm(obit~vphab+offset(log(dens))+purb+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
summary(m2.5)
summary(m2.4)
m2.4<-glm(obit~vphab+log(dens)+offset(purb)+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
summary(m2.4)
m2.3<-glm(obit~vphab+log(dens)+purb+offset(palf)+pdes+rmed+idh, family=poisson(link='log'),data=dados)
summary(m2.3)
m2.2<-glm(obit~vphab+log(dens)+purb+palf+offset(pdes)+rmed+idh, family=poisson(link='log'),data=dados)
summary(m2.2)
# Ajuste Glm Poisson offset
m2.1<-glm(obit~vphab+log(dens)+purb+palf+pdes+rmed+offset(idh), family=poisson(link='log'),data=dados)
summary(m2.1)
Ajuste = c('mod1','mod2','mod3','mod4','mod5','mod6')
Dev    = c(deviance(m2),deviance(m2.1),deviance(m2.2),
deviance(m2.3),deviance(m2.4),deviance(m2.5))
AIC    = c(AIC(m2),AIC(m2.1),AIC(m2.2),AIC(m2.3),AIC(m2.4),AIC(m2.5))
MaxVer = c(logLik(m2),logLik(m2.1),logLik(m2.2),
logLik(m2.3),logLik(m2.4),logLik(m2.5))
data.frame(Ajuste, Dev, AIC, MaxVer)
Ajuste = c('mod2','mod2.1','mod2.2','mod2.3','mod2.4','mod2.5')
data.frame(Ajuste, Dev, AIC, MaxVer)
# Ajuste Glm Poisson
m2<-glm(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
summary(m2)
summary(m2.1)
summary(m2.2) # DEV 1234,4 / AIC 1870,4
Ajuste = c('mod2','mod2.1','mod2.2','mod2.3','mod2.4','mod2.5')
Dev    = c(deviance(m2),deviance(m2.1),deviance(m2.2),
deviance(m2.3),deviance(m2.4),deviance(m2.5))
AIC    = c(AIC(m2),AIC(m2.1),AIC(m2.2),AIC(m2.3),AIC(m2.4),AIC(m2.5))
MaxVer = c(logLik(m2),logLik(m2.1),logLik(m2.2),
logLik(m2.3),logLik(m2.4),logLik(m2.5))
data.frame(Ajuste, Dev, AIC, MaxVer)
library(corrplot)
cor <- cor(dados[ , c(2,3,10,5,6,7,8,9)])
x11()
corrplot.mixed(cor, upper = "ellipse")
Ajuste = c('mod1','mod2','mod3','mod4','mod5','mod6')
Dev    = c(deviance(m1),deviance(m2),deviance(m3),
deviance(m4),deviance(m5),deviance(m6))
AIC    = c(AIC(m1),AIC(m2),AIC(m3),AIC(m4),AIC(m5),AIC(m6))
MaxVer = c(logLik(m1),logLik(m2),logLik(m3),
logLik(m4),logLik(m5),logLik(m6))
data.frame(Ajuste, Dev, AIC, MaxVer)
modelo3 <- gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZIP, data = dvisits)
library(ggplot2)
library(gridExtra)
library(corrplot)
library(readxl)
dados <- read_xls('Base_fim.xls',
col_types = c("text", "numeric", "numeric","numeric", "numeric",
"numeric","numeric", "numeric", "numeric"))
###################
# Análise Descritiva
###################
str(dados)
summary(dados)
head(dados)
# Quantidade de municípios por total de incidência
tabobt <- table(dados$obit)
tabpobt <- table(round(dados$obit/sum(dados$obit)*100, digits = 2))
X11()
par(mfrow=c(1,2))
barplot(tabobt)
barplot(tabpobt)
x11()
par(mfrow=c(3,3))
boxplot(dados$obit, xlab = '', ylab = '', main = 'Óbitos no Trânsito', las=1)
boxplot(dados$vphab, xlab = '', ylab = '', main = 'Veículos a cada 100 Habit', las=1)
boxplot(dados$dens, xlab = '', ylab = '', main = 'Densidade Demográfica', las=1)
boxplot(dados$purb, xlab = '', ylab = '', main = '% Pop Urbana', las=1)
boxplot(dados$palf, xlab = '', ylab = '', main = '% Alfabetizados', las=1)
boxplot(dados$pdes, xlab = '', ylab = '', main = '% Desmpregados', las=1)
boxplot(dados$rmed, xlab = '', ylab = '', main = '% Pop Baixa Renda', las=1)
boxplot(dados$idh, xlab = '', ylab = '', main = 'IDH', las=1)
x11()
par(mfrow=c(3,3))
boxplot(dados$obit, xlab = '', ylab = '', main = 'Óbitos no Trânsito', las=1)
boxplot(dados$vphab, xlab = '', ylab = '', main = 'Veículos a cada 100 Habit', las=1)
boxplot(dados$dens, xlab = '', ylab = '', main = 'Densidade Demográfica', las=1)
boxplot(dados$purb, xlab = '', ylab = '', main = '% Pop Urbana', las=1)
boxplot(dados$palf, xlab = '', ylab = '', main = '% Alfabetizados', las=1)
boxplot(dados$pdes, xlab = '', ylab = '', main = '% Desmpregados', las=1)
boxplot(dados$rmed, xlab = '', ylab = '', main = '% Pop Baixa Renda', las=1)
boxplot(dados$idh, xlab = '', ylab = '', main = 'IDH', las=1)
x11()
g1 <- ggplot(dados, aes(x=obit)) + geom_histogram()+ xlab('Óbitos no Trânsito')+ ylab('')
g2 <- ggplot(dados, aes(x=vphab)) + geom_histogram()+ xlab('Veículos a cada 100 Habit')+ ylab('')
g3 <- ggplot(dados, aes(x=dens)) + geom_histogram()+ xlab('Densidade Demográfica')+ ylab('')
g4 <- ggplot(dados, aes(x=purb)) + geom_histogram()+ xlab('% Pop Urbana')+ ylab('')
g5 <- ggplot(dados, aes(x=palf)) + geom_histogram()+ xlab('% Alfabetizados')+ ylab('')
g6 <- ggplot(dados, aes(x=pdes)) + geom_histogram()+ xlab('% Desmpregados')+ ylab('')
g7 <- ggplot(dados, aes(x=rmed)) + geom_histogram()+ xlab('Renda Média')+ ylab('')
g8 <- ggplot(dados, aes(x=idh)) + geom_histogram()+ xlab('IDH')+ ylab('')
grid.arrange(g1, g2, g3, g4, g5, g6, g7, g8, ncol=3, nrow=3)
dados$ldens  <- log(dados$dens)
x11()
par(mfrow = c(1,2))
hist(log(dados$dens), main = 'log(Densidade)', xlab = '', ylab = '')
boxplot(log(dados$dens), xlab = '', ylab = '', main = 'log(Densidade)')
library(corrplot)
cor <- cor(dados[ , c(2,3,10,5,6,7,8,9)])
x11()
corrplot.mixed(cor, upper = "ellipse")
library(car)
x11()
scatterplotMatrix(dados[ , c(2,3,10,5,6,7,8,9)],
smooth = list(smoother=loessLine, spread=TRUE,
col.smooth = 2, # Cor da média do smooth
col.spread = 2, # Cor do ic do smooth
lty.smooth=1, lwd.smooth=1.5,
lty.spread=3, lwd.spread=1),
regLine = list(method=lm, col = 1), # Cor da regressão
col = 3) # Cor dos pontos
library(gamlss)
# GLM com resposta Poisson
# Ajuste Gamlss Poisson
m1<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=PO, data=dados)
# Ajuste Glm Poisson
m2<-glm(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
summary(m2)
# Ajuste Glm.nb
m3<-glm.nb(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, data=dados)
# Ajuste Gamlss NBI
m4<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBI, data=dados)
# Ajuste Gamlss NBII
m5<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBII, data=dados)
# Ajuste Gamlss NBF
m6<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBF, data=dados)
modelo3 <- gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZIP, data = dvisits)
modelo3 <- gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZIP, data = dados)
summary(modelo3)
summary(m1)
summary(m2)
summary(modelo3)
summary(m1.7)
m1.7 <- gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZIP, data = dados)
summary(m1.7)
m1.1<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=PO, data=dados)
# Ajuste Glm Poisson
m1.2<-glm(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
# Ajuste Glm.nb
m1.3<-glm.nb(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, data=dados)
# Ajuste Gamlss NBI
m1.4<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBI, data=dados)
# Ajuste Gamlss NBII
m1.5<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBII, data=dados)
# Ajuste Gamlss NBF
m1.6<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBF, data=dados)
### Modelo 3: Poisson com inflação de zeros (mas sem covariáveis para o componente
### do excesso de zeros)
m1.7 <- gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZIP, data = dados)
x11()
par(mfrow = c(2,2))
plot(m1.1)
x11()
par(mfrow = c(2,2))
plot(m1.2)
x11()
par(mfrow = c(2,2))
plot(m1.3)
x11()
par(mfrow = c(2,2))
plot(m1.4)
x11()
par(mfrow = c(2,2))
plot(m1.5)
x11()
par(mfrow = c(2,2))
plot(m1.6)
x11()
par(mfrow = c(2,2))
plot(m1.7)
Ajuste = c('mod1','mod2','mod3','mod4','mod5','mod6','mod7')
Dev    = c(deviance(m1.1),deviance(m1.2),deviance(m1.3),
deviance(m1.4),deviance(m1.5),deviance(m1.6)
deviance(m1.7))
AIC    = c(AIC(m1.1),AIC(m1.2),AIC(m1.3),AIC(m1.4),AIC(m1.5),AIC(m1.6),AIC(m1.7))
MaxVer = c(logLik(m1.1),logLik(m1.2),logLik(m1.3),
logLik(m1.4),logLik(m1.5),logLik(m1.6)
logLik(m1.7))
data.frame(Ajuste, Dev, AIC, MaxVer)
Ajuste = c('mod1','mod2','mod3','mod4','mod5','mod6','mod7')
Dev    = c(deviance(m1.1),deviance(m1.2),deviance(m1.3),
deviance(m1.4),deviance(m1.5),deviance(m1.6),
deviance(m1.7))
AIC    = c(AIC(m1.1),AIC(m1.2),AIC(m1.3),AIC(m1.4),AIC(m1.5),AIC(m1.6),AIC(m1.7))
MaxVer = c(logLik(m1.1),logLik(m1.2),logLik(m1.3),
logLik(m1.4),logLik(m1.5),logLik(m1.6),
logLik(m1.7))
data.frame(Ajuste, Dev, AIC, MaxVer)
modelo4 <- gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZINBI, data = dvisits)
modelo4 <- gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZINBI, data = dados)
plot(modelo4)
summary(modelo4)
data.frame(Ajuste, Dev, AIC, MaxVer)
plot(modelo4)
modelo5 <- gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
sigma.formula = ~ obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZIP, data = dados)
modelo5 <- gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
sigma.formula = ~ vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZIP, data = dados)
summary(modelo5)
plot(modelo5)
plot(modelo4)
modelo6 <- gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
nu.formula = ~ vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZINBI, data = dados)
summary(modelo6)
plot(modelo6)
plot(modelo6)
summary(m2.3)
library(ggplot2)
library(gridExtra)
library(corrplot)
library(readxl)
dados <- read_xls('Base_fim.xls',
col_types = c("text", "numeric", "numeric","numeric", "numeric",
"numeric","numeric", "numeric", "numeric"))
str(dados)
summary(dados)
head(dados)
tabobt <- table(dados$obit)
tabpobt <- table(round(dados$obit/sum(dados$obit)*100, digits = 2))
X11()
par(mfrow=c(1,2))
barplot(tabobt)
barplot(tabpobt)
x11()
par(mfrow=c(3,3))
boxplot(dados$obit, xlab = '', ylab = '', main = 'Óbitos no Trânsito', las=1)
boxplot(dados$vphab, xlab = '', ylab = '', main = 'Veículos a cada 100 Habit', las=1)
boxplot(dados$dens, xlab = '', ylab = '', main = 'Densidade Demográfica', las=1)
boxplot(dados$purb, xlab = '', ylab = '', main = '% Pop Urbana', las=1)
boxplot(dados$palf, xlab = '', ylab = '', main = '% Alfabetizados', las=1)
boxplot(dados$pdes, xlab = '', ylab = '', main = '% Desmpregados', las=1)
boxplot(dados$rmed, xlab = '', ylab = '', main = '% Pop Baixa Renda', las=1)
boxplot(dados$idh, xlab = '', ylab = '', main = 'IDH', las=1)
x11()
g1 <- ggplot(dados, aes(x=obit)) + geom_histogram()+ xlab('Óbitos no Trânsito')+ ylab('')
g2 <- ggplot(dados, aes(x=vphab)) + geom_histogram()+ xlab('Veículos a cada 100 Habit')+ ylab('')
g3 <- ggplot(dados, aes(x=dens)) + geom_histogram()+ xlab('Densidade Demográfica')+ ylab('')
g4 <- ggplot(dados, aes(x=purb)) + geom_histogram()+ xlab('% Pop Urbana')+ ylab('')
g5 <- ggplot(dados, aes(x=palf)) + geom_histogram()+ xlab('% Alfabetizados')+ ylab('')
g6 <- ggplot(dados, aes(x=pdes)) + geom_histogram()+ xlab('% Desmpregados')+ ylab('')
g7 <- ggplot(dados, aes(x=rmed)) + geom_histogram()+ xlab('Renda Média')+ ylab('')
g8 <- ggplot(dados, aes(x=idh)) + geom_histogram()+ xlab('IDH')+ ylab('')
grid.arrange(g1, g2, g3, g4, g5, g6, g7, g8, ncol=3, nrow=3)
dados$ldens  <- log(dados$dens)
x11()
par(mfrow = c(1,2))
hist(log(dados$dens), main = 'log(Densidade)', xlab = '', ylab = '')
boxplot(log(dados$dens), xlab = '', ylab = '', main = 'log(Densidade)')
library(corrplot)
cor <- cor(dados[ , c(2,3,10,5,6,7,8,9)])
x11()
corrplot.mixed(cor, upper = "ellipse")
library(car)
x11()
scatterplotMatrix(dados[ , c(2,3,10,5,6,7,8,9)],
smooth = list(smoother=loessLine, spread=TRUE,
col.smooth = 2, # Cor da média do smooth
col.spread = 2, # Cor do ic do smooth
lty.smooth=1, lwd.smooth=1.5,
lty.spread=3, lwd.spread=1),
regLine = list(method=lm, col = 1), # Cor da regressão
col = 3) # Cor dos pontos
###################
# Ajuste dos Modelos de Regressão
###################
library(gamlss)
m1.1<-glm(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=poisson(link='log'),data=dados)
summary(m1.1)
x11()
par(mfrow = c(2,2))
plot(m1.1)
m1.2<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=PO, data=dados)
summary(m1.2)
x11()
par(mfrow = c(2,2))
plot(m1.2)
m1.3 <- gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,family = ZIP, data = dados)
summary(m1.3)
x11()
par(mfrow = c(2,2))
plot(m1.3)
m1.4<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
sigma.formula = ~ vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZIP, data = dados)
summary(m1.4)
x11()
par(mfrow = c(2,2))
plot(m1.4)
m2.1<-glm.nb(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, data=dados)
summary(m2.1)
x11()
par(mfrow = c(2,2))
plot(m2.1)
m2.2<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBI, data=dados)
summary(m2.2)
x11()
par(mfrow = c(2,2))
plot(m2.2)
m2.3<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBII, data=dados)
summary(m2.3)
x11()
par(mfrow = c(2,2))
plot(m2.3)
m2.4<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh, family=NBF, data=dados)
summary(m2.4)
x11()
par(mfrow = c(2,2))
plot(m2.4)
m2.5<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,family = ZINBI, data = dados)
summary(m2.5)
x11()
par(mfrow = c(2,2))
plot(m2.5) #ajuste interessante
m2.6<-gamlss(obit~vphab+log(dens)+purb+palf+pdes+rmed+idh,
nu.formula = ~ vphab+log(dens)+purb+palf+pdes+rmed+idh,
family = ZINBI, data = dados)
summary(m2.6)
x11()
par(mfrow = c(2,2))
plot(m2.6)
Ajuste = c('Po_Glm','Po_Gaml','Po_Zip','Po_ZipIPCov',
'Bn_Glm','Bn_TpI','Bn_TpII','Bn_Fam','Bn_Zinbi','Bn_ZinbiCOv')
Dev    = c(deviance(m1.1),deviance(m1.2),deviance(m1.3),deviance(m1.4),
deviance(m2.1),deviance(m2.2),deviance(m2.3),
deviance(m2.4),deviance(m2.3),deviance(m2.3))
AIC    = c(AIC(m1.1),AIC(m1.2),AIC(m1.3),AIC(m1.4),
AIC(m2.1),AIC(m2.2),AIC(m2.3),
AIC(m2.4),AIC(m2.5),AIC(m2.6))
MaxVer = c(logLik(m1.1),logLik(m1.2),logLik(m1.3),logLik(m1.4),
logLik(m2.1),logLik(m2.2),logLik(m2.3),
logLik(m2.4),logLik(m2.5),logLik(m2.7))
MaxVer = c(logLik(m1.1),logLik(m1.2),logLik(m1.3),logLik(m1.4),
logLik(m2.1),logLik(m2.2),logLik(m2.3),
logLik(m2.4),logLik(m2.5),logLik(m2.6))
Ajuste = c('Po_Glm','Po_Gaml','Po_Zip','Po_ZipIPCov',
'Bn_Glm','Bn_TpI','Bn_TpII','Bn_Fam','Bn_Zinbi','Bn_ZinbiCOv')
Dev    = c(deviance(m1.1),deviance(m1.2),deviance(m1.3),deviance(m1.4),
deviance(m2.1),deviance(m2.2),deviance(m2.3),
deviance(m2.4),deviance(m2.5),deviance(m2.6))
AIC    = c(AIC(m1.1),AIC(m1.2),AIC(m1.3),AIC(m1.4),
AIC(m2.1),AIC(m2.2),AIC(m2.3),
AIC(m2.4),AIC(m2.5),AIC(m2.6))
MaxVer = c(logLik(m1.1),logLik(m1.2),logLik(m1.3),logLik(m1.4),
logLik(m2.1),logLik(m2.2),logLik(m2.3),
logLik(m2.4),logLik(m2.5),logLik(m2.6))
data.frame(Ajuste, Dev, AIC, MaxVer)
Ajuste = c('Po_Glm-1.1','Po_Gaml-1.2','Po_Zip-1.3','Po_ZipIPCov-1.4',
'Bn_Glm-2.1','Bn_TpI-2.2','Bn_TpII-2.3','Bn_Fam-2.4','Bn_Zinbi-2.5','Bn_ZinbiCOv-2.6')
data.frame(Ajuste, Dev, AIC, MaxVer)
plot(m2.1)
x11()
par(mfrow = c(2,2))
plot(m2.1)
library(hnp)
hnp(m1.1, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
X11()
hnp(m1.1, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
X11()
par(mfrow = c(2,2))
hnp(m1.1, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
hnp(m1.2, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
hnp(m1.3, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
hnp(m1.4, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
X11()
par(mfrow = c(2,2))
hnp(m1.1)
hnp(m1.2)
hnp(m1.3)
hnp(m1.4)
X11()
par(mfrow = c(3,2))
hnp(m2.1, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
hnp(m2.2, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
hnp(m2.3, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
hnp(m2.4, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
hnp(m2.5, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
hnp(m2.6, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
X11()
par(mfrow = c(2,1))
hnp(m1.1, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
hnp(m2.1, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
X11()
par(mfrow = c(1,2))
hnp(m1.1, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
hnp(m2.1, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
summary(m2.1)
m2.1.1 <- step(m2.1, direction = "both")
# O resumo do novo modelo ajustado:
summary(m2.1.1)
anova(m2.1, m2.1.1)
library(car)
influenceIndexPlot(m2.1.1, vars=c("Cook", "Studentized", "hat"), main="Medidas de Influência")
library(statmod)
res <- qresiduals(m2.1.1)
X11()
par(mfrow=c(1,2))
plot(res)
residuos <- qresiduals(m2.1.1)
qqnorm(residuos)
qqline(residuos, col = 2)
# Vamos verificar o comportamento do gráfico Normal de probabilidades com envelope
# simulado para o modelo reajustado:
hnp(m2.1.1, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
x11()
hnp(m2.1.1, xlab = 'Percentil da N(0,1)', ylab = 'Resíduos', main = 'Gráfico Normal de Probabilidades')
library(effects)
plot(allEffects(m2.1.1), type = 'response', main = '')
